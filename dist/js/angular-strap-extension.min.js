!function(e,t){"use strict";function n(e){e.$$phase||e.$root&&e.$root.$$phase||e.$digest()}function i(e,t){var e=e;do{if(e===t)return!0;e=e.parentNode}while(e);return!1}angular.module("kk.util",["kk.util.tab","kk.util.tooltip","kk.util.typeahead","kk.util.select","kk.util.popover","kk.util.modal","kk.util.spin","kk.util.slider","kk.util.pagination","kk.util.uploader"]),angular.module("kk.util.select",["kk.util.tooltip","kk.util.parseOptions"]).provider("$kkselect",[function(){var e={trigger:"focus",templateUrl:"kk/select.tpl.html",placement:"bottom-left",placeholder:"请选择一个...",caretHtml:'&nbsp;<span class="caret"></span>'};this.$get=["$tooltip","$kkparseOptions",function(t,i){function a(i,a,o){var l,s=angular.extend({},e,o);l=t(i,s);var r=l.$scope;r.$matches=[],r.$isVisible=function(){return l.$isVisible()},r.$select=function(e,t){l.select(e,t)},l.select=function(e,t){var n=r.$matches[e].value;a.$setViewValue(n),l.activate(e),l.hide()},l.$onMouseDown=function(e){e.preventDefault(),e.stopPropagation()};var c=l.show;l.show=function(){c(),l.$element.on("mousedown",l.$onMouseDown)};var u=l.hide;return l.hide=function(){u(),l.$element.off("mousedown",l.$onMouseDown)},l.update=function(e){r.$matches=e,n(r)},l.$getIndex=function(e){var t;for(t=r.$matches.length;t--&&!angular.equals(r.$matches[t].value,e););return t},l.$isVisible=function(){return r.$matches.length},r.$isActive=l.$isActive=function(e){return r.$activeIndex===e},l.activate=function(e){r.$activeIndex=e},l}return a.defaults=e,a}]}]).directive("kkSelect",["$kkselect","$kkparseOptions","$sce",function(e,t,n){var i=e.defaults;return{restrict:"A",require:"ngModel",link:function(a,o,l,s){var r={scope:a,placeholder:i.placeholder};angular.forEach(["templateUrl","placement","trigger","animation","caretHtml","placeholder","html"],function(e){angular.isDefined(l[e])&&(r[e]=l[e])});var c=e(o,s,r),u=t(l.kkOptions);a.$watch(l.ngModel,function(e,t){s.$render()}),a.$watch(u.valuesName,function(e,t){var i=u.valuesFn(a,s);if(r.html){var o=[];angular.forEach(i,function(e){e.label=n.trustAsHtml(e.label),o.push(e)}),c.update(o)}else c.update(i)}),s.$render=function(){var e=c.$getIndex(s.$modelValue),t=-1!==e&&c.$scope.$matches[e].label;o.html((t||r.placeholder)+(r.caretHtml||i.caretHtml))}}}}]).run(["$templateCache",function(e){e.put("kk/select.tpl.html",'<ul tabindex="-1" class="select dropdown-menu" ng-show="$isVisible()" role="select"><li ng-if="$showAllNoneButtons"><div class="btn-group" style="margin-bottom: 5px; margin-left: 5px"><button type="button" class="btn btn-default btn-xs" ng-click="$selectAll()">{{$allText}}</button> <button type="button" class="btn btn-default btn-xs" ng-click="$selectNone()">{{$noneText}}</button></div></li><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $isActive($index)}"><a style="cursor: default" role="menuitem" tabindex="-1" ng-click="$select($index, $event)"><i class="{{$iconCheckmark}} pull-right" ng-if="$isMultiple && $isActive($index)"></i> <span ng-bind="match.label"></span></a></li></ul>')}]),angular.module("kk.util.tab",["ngAnimate"]).provider("$tab",function(){var e={templateUrl:"kk/tab.tpl.html",activeClass:"active",navClass:"nav-tabs"},t=function(t){var n=this;n.$options=angular.copy(e),t.$navClass=n.$options.navClass,t.$activeClass=n.$options.activeClass,n.$activePaneChangeListeners=t.$activePaneChangeListeners=[],n.$panes=t.$panes=[],n.$push=function(e){n.$panes.push(e)},n.$setActive=t.$setActive=function(e){n.$panes.$active=e,n.$activePaneChangeListeners.forEach(function(e){e()})},n.$isActive=t.$isActive=function(e,t){return n.$panes.$active===e.name||n.$panes.$active===t}};this.$get=[function(){var n={};return n.controller=t,n.defaults=e,n}]}).directive("kkTabSet",["$tab","$parse",function(e,t){e.defaults;return{restrict:"EA",controller:["$scope",e.controller],require:["kkTabSet"],templateUrl:function(t,n){return n.templateUrl||e.defaults.templateUrl},scope:!0,transclude:!0,link:function(e,n,i,a){var o=a[0];if(i.kkActiveTab){var l=t(i.kkActiveTab);o.$activePaneChangeListeners.push(function(){l.assign(e,o.$panes.$active)}),e.$watch(i.kkActiveTab,function(e){o.$setActive(e)},!0)}}}}]).directive("kkTab",["$sce","$tab","$animate",function(e,t,n){return{restrict:"EA",require:["^kkTabSet"],scope:!0,link:function(t,i,a,o){function l(){var e=s.$panes.indexOf(t);t.name||(t.name=t.title),n[s.$isActive(t,e)?"addClass":"removeClass"](i,s.$options.activeClass)}var s=o[0];i.addClass("tab-pane"),a.$observe("title",function(n){t.title=e.trustAsHtml(n)}),t.name=a.name,s.$push(t),s.$activePaneChangeListeners.push(function(){l()}),l()}}}]).run(["$templateCache",function(e){e.put("kk/tab.tpl.html",'<ul class="nav" ng-class="$navClass" role="tablist"><li role="presentation" ng-repeat="$pane in $panes track by $index" ng-class="[ $isActive($pane, $index) ? $activeClass : \'\', $pane.disabled ? \'disabled\' : \'\' ]"><a role="tab" data-toggle="tab" ng-click="!$pane.disabled && $setActive($pane.name || $index)" data-index="{{ $index }}" ng-bind-html="$pane.title" aria-controls="$pane.title" href=""></a></li></ul><div ng-transclude class="tab-content"></div>')}]),angular.module("kk.util.typeahead",["kk.util.tooltip","kk.util.parseOptions"]).provider("$kktypeahead",function(){var e=this.defaults={animation:"am-fade",templateUrl:"kk/typehead.tpl.html",trigger:"focus",filter:"kkAsyncFilter",autoSelect:!1,placement:"bottom-left",keyboard:!0,limit:6,comparator:"",minLength:1};this.$get=["$tooltip","$timeout",function(t,i){function a(i,a,o){var l=angular.extend({},e,o),s=t(i,l),r=s.$scope;r.$resetMatches=function(){r.$matches=[],r.$activeIndex=l.autoSelect?0:-1},r.$resetMatches(),r.$isVisible=function(){return s.$isVisible()},r.$select=function(e,t){r.$$postDigest(function(){s.select(e)})},s.select=function(e){if(-1!==e){var t=r.$matches[e].value;a.$setViewValue(t),a.$render(),r.$resetMatches(),n(r)}};var c=s.show;s.show=function(){c(),s.$element.on("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),l.keyboard&&i.on("keydown",s.$onKeyDown)};var u=s.hide;return s.hide=function(){u(),l.keyboard&&i.off("keydown",s.$onKeyDown)},s.$isVisible=function(){return r.$matches.length&&a.$viewValue.length>=l.minLength},s.update=function(e){r.$matches=e,n(r)},s.activate=function(e){r.$activeIndex=e},s.$getIndex=function(e){var t;for(t=r.$matches.length;t--&&!angular.equals(r.$matches[t].value,e););return t},s.$onKeyDown=function(e){/(38|40|13|27)/.test(e.keyCode)&&(!s.$isVisible()||13===e.keyCode&&-1===r.$activeIndex||(e.preventDefault(),e.stopPropagation()),13===e.keyCode&&r.$matches.length?s.select(r.$activeIndex):27===e.keyCode?s.hide():40===e.keyCode?r.$activeIndex=++r.$activeIndex%r.$matches.length:38===e.keyCode&&(r.$activeIndex=-1==--r.$activeIndex?r.$matches.length-1:r.$activeIndex),r.$digest())},s}return a.defaults=e,a}]}).filter("kkAsyncFilter",["$filter",function(e){return function(t,n,i){return e("filter")(t,n,i)}}]).directive("kkTypeahead",["$kktypeahead","$kkparseOptions","$timeout",function(e,t,n){var i=e.defaults;return{restrict:"A",require:"ngModel",link:function(n,a,o,l){var s={scope:n};angular.forEach(["placement","trigger","filter","limit","autoSelect","animation","minLength"],function(e){angular.isDefined(o[e])&&(s[e]=o[e])});var r=e(a,l,s),c=o.kkOptions,u=angular.isDefined(s.filter)?s.filter:i.filter,p=s.limit||i.limit,d=s.comparator||i.comparator;u&&(c+=" | "+u+":$viewValue",d&&(c+=":"+d)),p&&(c+=" | limitTo:"+p);var f=t(c);n.$watch(o.ngModel,function(e,t){var i=f.valuesFn(n,l);r.update(i)})}}}]).run(["$templateCache",function(e){e.put("kk/typehead.tpl.html",'<ul tabindex="-1" class="typeahead dropdown-menu" ng-show="$isVisible()" role="select"><li role="presentation" ng-repeat="match in $matches" ng-class="{active: $index == $activeIndex}"><a role="menuitem" tabindex="-1" ng-click="$select($index, $event)" ng-bind="match.label"></a></li></ul>')}]),angular.module("kk.util.popover",["kk.util.tooltip"]).provider("$popover",function(){var e={placement:"top",templateUrl:"kk/popover.tpl.html",trigger:"click",animation:"am-fade-y"};this.$get=["$tooltip","$timeout","$document",function(t,a,o){function l(l,s,r){var c=angular.extend({},e,r),u=t(l,c),p=u.$scope;if(c.content&&(u.$scope.content=c.content),!c.popoverEdit){var d=u.show;u.show=function(){d(),a(function(){u.$element[0].focus()}),n(p),o.on("click",u.$onClick)};var f=u.hide;u.hide=function(){u.$element.off("keydown",u.onKeyDown),o.off("click",u.$onClick),f()},u.$onClick=function(e){i(e.target,u.$element[0])||e.target===l[0]||u.hide()}}if(c.popoverEdit){p.update=function(e){p.$$postDigest(function(){p.$model.model=e})},p.submit=function(){s.$setViewValue(p.$model),s.$render(),u.hide()},p.cancel=function(){p.$model=p.$temp,p.$temp=null,u.hide()},p.clear=function(){p.$model.model=""};var d=u.show;u.show=function(){p.$temp=angular.copy(p.$model),d(),n(p),u.$element.find("input")[0].focus(),u.$element.on("keydown",u.onKeyDown)};var f=u.hide;u.hide=function(){u.$element.off("keydown",u.onKeyDown),f()},u.onKeyDown=function(e){return 13===e.keyCode?(e.preventDefault(),e.stopPropagation(),void p.submit()):27===e.keyCode?(e.preventDefault(),e.stopPropagation(),void p.cancel()):void 0}}return u}return l.defaults=e,l}]}).directive("kkPopover",["$popover","$sce",function(e,t){return{restrict:"A",link:function(n,i,a,o){var l={scope:n};angular.forEach(["html"],function(e){angular.isDefined(a[e])&&(l[e]=a[e])}),n.$watch(a.kkPopover,function(e){if(angular.isObject(e)){if(l.html)for(var i in e)e[i]=t.trustAsHtml(e[i]);angular.extend(n,e)}else n.content=e}),e(i,o,l)}}}]).directive("kkPopoverEdit",["$popover","$sce","$timeout",function(e,t,n){var i={templateUrl:"kk/popover.edit.tpl.html",trigger:"click",popoverEdit:!0};return{restrict:"A",require:"ngModel",scope:{$model:"=ngModel"},link:function(t,n,a,o){var l={scope:t};angular.extend(l,i);e(n,o,l);o.$render=function(){""===o.$viewValue.model?n.html(" "):n.html(o.$viewValue.model)}}}}]).run(["$templateCache",function(e){e.put("kk/popover.tpl.html",'<div class="popover"><div class="arrow"></div><h3 class="popover-title" ng-bind="title" ng-show="title"></h3><div class="popover-content" ng-bind="content"></div></div>'),e.put("kk/popover.edit.tpl.html",'<div class="popover"><div class="arrow"></div><h3 class="popover-title" ng-bind="$model.title" ng-show="$model.title"></h3><div class="popover-content"><form class="form-inline"><div class="control-group form-group" style="white-space: nowrap"><div class="editable-input" style="position: relative"><input type="text" class="form-control input-sm" ng-model="$model.model"/><span class="editable-clear-x" ng-click="clear()"></span></div><div class="editable-buttons"><button class="btn btn-primary btn-sm" ng-click="submit()"><i class="glyphicon glyphicon-ok"></i></button><button class="btn btn-default btn-sm editable-cancel" ng-click="cancel()"><i class="glyphicon glyphicon-remove"></i></button></div></div></form></div></div>')}]),angular.module("kk.util.modal",[]).provider("$modal",function(){var e=0,i={templateUrl:"kk/modal.tpl.html",animation:"am-fade",backdropAnimation:"am-fade",prefixEvent:"modal",backdrop:!0,placement:"top",keyboard:!0,container:!1,show:!0,backdropHideOnClick:!0};this.$get=["$kkCompiler","$window","$animate","$timeout",function(a,o,l,s){function r(r){function c(){A.on("click",function(e){w.hide()}),b.on("click",function(e){e.target===e.currentTarget&&w.hide()})}function u(){C.$on(y.prefixEvent+"."+y.id+".show",function(e){w.show()}),C.$on(y.prefixEvent+"."+y.id+".hide",function(e){w.hide()})}function p(){b.on("keyup",function(e){27===e.keyCode?w.hide():13===e.keyCode&&w.submit()})}function d(){angular.isDefined(y.onShow)&&C.$eval(y.onShow)}function f(){angular.isDefined(y.onHide)&&C.$eval(y.onHide)}function m(){}function v(){}function h(){k&&(k.$destroy(),k=null),b&&(b.remove(),b=w.$element=null)}function $(e,n){return angular.element((n||t).querySelectorAll(e))}var g,k,b,w={},y=angular.extend({},i,r),x=a.compile(y),C=w.$scope=y.scope&&y.scope.$new()||$rootScope.$new(),A=angular.element('<div class="modal-backdrop"></div>'),E=0,D=1040,S=1050;return x.then(function(e){g=e}),C.$hide=function(){w.hide()},C.$submit=function(){w.submit()},w.init=function(){y.id||(e++,y.id=e),y.backdropAnimation&&A.addClass(y.backdropAnimation),y.show&&C.$$postDigest(function(){w.show()}),u()},w.init(),w.show=function(){b&&h();var e,t;k=C.$new(),b=g.link(k),y.container?(e=$(y.container),t=e[0].lastchild):(e=angular.element(o.document.body),t=null),angular.isDefined(y.onBeforeShow)&&C.$eval(y.onBeforeShow),b.css({display:"block"}).addClass(y.placement),y.animation&&b.addClass(y.animation),y.zIndex&&(S=y.zIndex,D=S-10),y.backdrop&&(b.css({"z-index":S+20*E}),A.css({"z-index":D+20*E}),E++,l.enter(A,e,t).then(m)),l.enter(b,e,t).then(d),s(function(){b[0].focus()}),y.backdropHideOnClick&&c(),y.keyboard&&p(),n(k)},w.hide=function(){angular.isDefined(y.onBeforeHide)&&C.$eval(y.onBeforeHide),l.leave(A).then(v),l.leave(b).then(f),b&&b.remove(),n(k)},w.submit=function(){l.leave(A),l.leave(b),n(k)},w}return r}]}).provider("$modalLoading",function(){var e={templateUrl:"kk/modal.loading.tpl.html",animation:"am-fade-y",backdropEvent:!1};this.$get=["$modal",function(t){function n(n){var i=angular.extend({},e,n);return t(i)}return n}]}).directive("kkModal",["$modal","$sce",function(e,t){return{restrict:"A",scope:!0,link:function(n,i,a){var o={scope:n,show:!1};angular.forEach(["animation","container","zIndex","backdrop","title","content","html","placement","keyboard","templateUrl","show","backdropHideOnClick","id"],function(e){angular.isDefined(a[e])&&(o[e]=a[e])}),angular.forEach(["onBeforeShow","onShow","onBeforeHide","onHide"],function(e){var t="kk"+e.charAt(0).toUpperCase()+e.slice(1);angular.isDefined(a[t])&&(o[e]=a[t])});var l=/false/;angular.forEach(["backdrop","keyboard","container","show","backdropEvent"],function(e){angular.isDefined(a[e])&&l.test(a[e])&&(o[e]=!1)});var s=e(o);i.on("click",function(){s.show()}),angular.forEach(["title","content"],function(e){a[e]&&a.$observe(e,function(i){n[e]=t.trustAsHtml(i)})})}}}]).directive("kkModalLoading",["$modalLoading",function(e){return{restrict:"AE",scope:!0,link:function(t,n,i){var a={scope:t,show:!1};angular.forEach(["animation","container","zIndex","backdrop","title","content","html","placement","keyboard","templateUrl","show","backdropHideOnClick","id"],function(e){angular.isDefined(i[e])&&(a[e]=i[e])}),angular.forEach(["onBeforeShow","onShow","onBeforeHide","onHide"],function(e){var t="kk"+e.charAt(0).toUpperCase()+e.slice(1);angular.isDefined(i[t])&&(a[e]=i[t])});var o=/false/;angular.forEach(["backdrop","keyboard","container","show","backdropHideOnClick"],function(e){angular.isDefined(i[e])&&o.test(i[e])&&(a[e]=!1)});e(a)}}}]).run(["$templateCache",function(e){e.put("kk/modal.tpl.html",'<div class="modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header" ng-show="title"><button type="button" class="close" aria-label="Close" ng-click="$hide()"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" ng-bind="title"></h4></div><div class="modal-body" ng-bind="content"></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="$hide()">Close</button><button type="button" class="btn btn-default" ng-click="$submit()">Submit</button></div></div></div></div>'),e.put("kk/modal.loading.tpl.html",'<i class="fa fa-spinner fa-pulse fa-3x fa-fw" style="position: fixed;left: 50%;top: 50%;color: white"></i>')}]),angular.module("kk.util.spin",[]).directive("kkSpin",[function(){return{restrict:"A",link:function(e,n,i){function a(e){o();var i=e.lines,a=angular.element('<div style="position: '+e.position+";left:"+e.left+"%;top:"+e.top+'%">');n.append(a);for(var s=e.length*e.scale,r=e.width*e.scale,c=e.corners*r/2,u=0;u<i;u++){var p=angular.element('<div style="position:absolute;width: '+s+"px;height: "+r+"px;opacity:"+e.opacity+";background: "+e.color+";border-radius: "+c+"px;animation: mymove-"+u+" "+e.repeatTime+"s infinite;transform:rotate("+360/i*u+"deg) translate("+e.radius*e.scale+'px,0px);transform-origin: left center 0">');a.append(p)}l=t.createElement("style"),l.type="text/css",t.head.appendChild(l);for(var d=l.sheet||l.styleSheet,u=0;u<i;u++){var f;f=-1==e.direction?((i-u)/i+.01)%1:(u/i+.01)%1;var m=f+.6,v=e.opacity;m>=1&&(m%=1,v=1-(1-f)/.6*(1-e.opacity));var h="@keyframes mymove-"+u+" {0%{opacity: "+v+"}"+100*f+"%{opacity: "+e.opacity+"}"+(100*f+.01)+"%{opacity:1}"+100*m+"%{opacity:"+e.opacity+"}100%{opacity:"+v+"}}";d.insertRule(h,d.cssRules.length)}}function o(){n.empty(),l&&t.head.removeChild(l)}var l;e.$watch(i.kkSpin,function(e){a(e)},!0)}}}]),angular.module("kk.util.slider",[]).provider("$slider",function(){this.$get=[function(){function e(e,t){t.scope;return{}}return e}]}).directive("kkSlide",["$slider","$timeout","$document","$parse",function(e,t,i,a){return{restrict:"AE",templateUrl:"kk/slider.tpl.html",scope:!0,link:function(t,o,l){function s(){var e=d[0].offsetWidth,t=e*(c/u);f.css("width",t+"px"),m.css("left",t-2+"px")}var r,c=t.value=t.$eval(l.value),u=t.$eval(l.maxValue),p=t.$eval(l.precesion),d=angular.element(o[0].getElementsByClassName("kk-slider-bar")[0]),f=angular.element(o[0].getElementsByClassName("kk-slider-range")[0]),m=angular.element(o[0].getElementsByClassName("kk-slider-handle")[0]),v=!1,h={scope:t},$=e(o,h);m.on("mousedown",function(e){v=!0,r=e.clientX-e.currentTarget.offsetLeft}),i.on("mouseup",function(e){v&&(v=!1,m.triggerHandler("mouseout"))}),i.on("mousemove",function(e){if(v){var i=d[0].offsetWidth,o=e.clientX-r;o<=0?o=0:o>i&&(o=i);var s=(o/i*u).toFixed(p);o*=s/(o/i*u),a(l.value).assign(t.$parent,s),m.css("left",o-1+"px"),m.triggerHandler("mouseover"),n(t.$parent)}}),t.$slideModel={},t.$watch(l.value,function(e){c=e,t.$slideModel.title=e,s()}),t.$watch(l.maxValue,function(e){$.maxValue=e}),l.$observe("precesion",function(e){p=e})}}}]).run(["$templateCache",function(e){e.put("kk/slider.tpl.html",'<span class="kk-slider"><span class="kk-slider-range"></span><span class="kk-slider-bar" ></span><span class="kk-slider-handle" kk-tooltip data-animation="false" data-title="{{$slideModel.title}}"></span></span>')}]),angular.module("kk.util.tooltip",["kk.util.core","kk.util.dimensions"]).provider("$tooltip",function(){var e={templateUrl:"kk/tooltip.tpl.html",animation:"am-fade",prefixClass:"tooltip",placement:"top",trigger:"hover focus",zIndex:1040};this.$get=["$rootScope","$kkCompiler","$animate","$$rAF","$timeout","dimensions",function(t,n,i,a,o,l){function s(a,o){function l(){var e=g.trigger.split(" ");angular.forEach(e,function(e){"click"===e?a.on(e,$.toggle):"hover"===e?(a.on("mouseenter",$.show),a.on("mouseleave",$.hide)):"focus"===e&&(a.on("focus",$.show),a.on("blur",$.hide))})}function s(e){v.css({top:e.top+"px",left:e.left+"px"})}function r(e,t,n,i){var o,l=e.split("-");switch(l[0]){case"right":o={top:a[0].offsetTop+a[0].offsetHeight/2-i/2,left:a[0].offsetLeft+a[0].offsetWidth};break;case"left":o={top:a[0].offsetTop+a[0].offsetHeight/2-i/2,left:a[0].offsetLeft-n};break;case"top":o={top:a[0].offsetTop-i,left:a[0].offsetLeft+a[0].offsetWidth/2-v[0].offsetWidth/2},l[1]&&("left"===l[1]?o.left=a[0].offsetLeft-n:"right"===l[1]&&(o.left=a[0].offsetLeft+a[0].offsetWidth));break;case"bottom":o={top:a[0].offsetTop+a[0].offsetHeight,left:a[0].offsetLeft+a[0].offsetWidth/2-v[0].offsetWidth/2},l[1]&&("left"===l[1]?o.left=a[0].offsetLeft:"right"===l[1]&&(o.left=a[0].offsetLeft+a[0].offsetWidth))}return o}function c(e){e=e||g.target||a;var t=e[0],n=(t.tagName,t.getBoundingClientRect()),i={};for(var o in n)i[o]=n[o];return angular.extend({},i)}function u(e){e.$$phase||e.$root&&e.$root.$$phase||e.$digest()}function p(){angular.isDefined(g.onShow)&&angular.isFunction(g.onShow)&&g.onShow($)}function d(){}var f,m,v,h,$={},g=$.$options=angular.extend({},e,o),k=$.$promise=n.compile(g),b=$.$scope=g.scope&&g.scope.$new()||t.$new;return k.then(function(e){f=e,$.init()}),$.init=function(){angular.isElement(g.container)&&(h=g.container),l()},$.show=function(){if(!$.$isShown){var e,t;e=null,t=a,m=$.$scope.$new(),v=$.$element=f.link(m,function(){}),v.css({top:"-9999px",left:"-9999px",right:"auto",display:"block",visibility:"hidden",position:"absolute","z-index":g.zIndex,"user-select":"none"}),g.animation&&v.addClass(g.animation),$.$isShown=!0,u(b),i.enter(v,e,t).then(p),$.$applyPlacement(),v.css({visibility:"visible"})}},$.$isVisible=function(){return $.$isShown},$.hide=function(){$.$isShown&&($.$isShown=!1,i.leave(v).then(d),g.animation||v.remove(),u(b))},$.toggle=function(){$.$isShown?$.hide():$.show()},$.$applyPlacement=function(){if(v){var e=g.placement;v.addClass(g.placement);for(var t=c(),n=(a[0].ownerElement,a[0]),i=0;n.parentNode;)i+=n.scrollTop,n=n.parentNode;s(r(e,t,v.prop("offsetWidth"),v.prop("offsetHeight")))}},$}return s}]}).directive("kkTooltip",["$tooltip","$http","$sce","$$rAF",function(e,t,n,i){return{restrict:"A",scope:!0,link:function(t,a,o,l){var s,r={scope:t};angular.forEach(["trigger","templateUrl","placement","animation"],function(e){angular.isDefined(o[e])&&(r[e]=o[e])});var c=/false/;angular.forEach(["animation"],function(e){angular.isDefined(o[e])&&c.test(o[e])&&(r[e]=!1)}),o.$observe("title",function(e){if(angular.isDefined(e)){var a=t.title;t.title=n.trustAsHtml(e),angular.isDefined(a)&&i(function(){s&&s.$applyPlacement()})}}),s=e(a,r),t.$on("$destory",function(){s&&s.destory(),r=null,s=null})}}}]).run(["$templateCache",function(e){e.put("kk/tooltip.tpl.html",'<div class="tooltip in" ng-show="title"><div class="tooltip-arrow"></div><div class="tooltip-inner" ng-bind="title" style="white-space: nowrap"></div></div>')}]),angular.module("kk.util.parseOptions",[]).provider("$kkparseOptions",function(){var e={regexp:/(.*?)\s+(?:as(.*?)\s+)?for\s+(.*?)\s+in\s+(.*?)$/};this.$get=["$parse",function(t){function n(n){var i,a,o,l,s,r={};return r.init=function(){r.$match=i=n.match(e.regexp),o=t(i[2]||i[1]),a=i[3],l=t(i[4]),r.valuesName=i[4],s=t(i[2]?i[1]:a)},r.valuesFn=function(e,t){return l(e,t).map(function(t,n){var i,l,r={};return r[a]=t,i=o(e,r),l=s(e,r),{label:i,value:l,index:n}})},r.displayValue=function(e){var t={};return t[a]=e,o(t)},r.init(),r}return n}]}),angular.module("kk.util.core",[]).service("$kkCompiler",["$q","$http","$injector","$compile","$controller","$templateCache",function(e,t,n,i,a,o){function l(e){return s[e]||(s[e]=t.get(e,{cache:o}).then(function(e){return e.data}))}this.compile=function(t){var n=t.templateUrl,a=(t.transformTemplate||angular.identity,t.resolve||{});return a.$template=l(n),e.all(a).then(function(e){var n=e.$template;t.html&&(n=n.replace(/ng-bind="/gi,'ng-bind-html="'));var a=angular.element("<div>").html(n.trim()).contents(),o=i(a);return{locals:e,element:a,link:function(e){return o.apply(null,arguments)}}})};var s={}}]),angular.module("kk.util.dimensions",[]).factory("dimensions",function(){var t={};return t.offset=function(t){var n=t.getBoundingClientRect(),i=t.ownerDocument;return{width:n.width||t.offsetWidth,height:n.height||t.offsetHeight,top:n.top+(e.pageYOffset||i.documentElement.scrollTop)-(i.documentElement.clientTop||0),left:n.left+(e.pageXOffset||i.documentElement.scrollLeft)-(i.documentElement.clientLeft||0)}},t.css=function(t,n,i){var a;return a=t.currentStyle?t.currentStyle[n]:e.getComputedStyle?e.getComputedStyle(t)[n]:t.style[n],!0===i?parseFloat(a)||0:a},t.setOffset=function(e,n,i){var a,o,l,s,r,c,u,p=t.css(e,"position"),d=angular.element(e),f={};"static"===p&&(e.style.position="relative"),r=t.offset(e),l=t.css(e,"top"),c=t.css(e,"left"),u=("absolute"===p||"fixed"===p)&&(l+c).indexOf("auto")>-1,u?(a=t.position(e),s=a.top,o=a.left):(s=parseFloat(l)||0,o=parseFloat(c)||0),angular.isFunction(n)&&(n=n.call(e,i,r)),null!==n.top&&(f.top=n.top-r.top+s),null!==n.left&&(f.left=n.left-r.left+o),"using"in n?n.using.call(d,f):d.css({top:f.top+"px",left:f.left+"px"})},t}),angular.module("kk.util.pagination",[]).provider("$pagination",[function(){this.$get=function(){function e(){return{}}return e}}]).directive("kkPagination",["$http","$templateCache","$compile","$parse",function(e,t,n,i){var a=0,o=1,l=2,s=3,r=4,c=5,u={series:5};return{restrict:"EA",require:"ngModel",scope:!0,templateUrl:"kk/pagination.tpl.html",link:function(e,t,n,i){function p(e,t){this.value=e,this.type=t,this.class}function d(){e.items=[];var t=null,n=new p("首页",a);e.items.push(n);var i=new p("上一页",o);if(e.items.push(i),m<=v)if(f<=v+1)for(var u=1;u<=f;u++){var d=new p(u,l);e.items.push(d),m==u&&(d.class="active",t=d)}else{for(var u=1;u<=v;u++){var d=new p(u,l);e.items.push(d),m==u&&(d.class="active",t=d)}e.items.push(new p("...",s)),e.items.push(new p(f,l))}else if(m>v){e.items.push(new p(1,l));var h=Math.floor((m-1)/v)*v;if(f>h+v+1){e.items.push(new p("...",s));for(var u=h+1;u<=h+v;u++){var d=new p(u,l);m==u&&(d.class="active",t=d),e.items.push(d)}e.items.push(new p("...",s)),e.items.push(new p(f,l))}else{e.items.push(new p("...",s));for(var u=h+1;u<=f;u++){var d=new p(u,l);m==u&&(d.class="active",t=d),e.items.push(d)}}}var $=new p("下一页",r);e.items.push($);var g=new p("尾页",c);e.items.push(g),1==t.value&&(void 0===i.class&&(i.class=""),i.class+=" disabled",void 0===n.class&&(n.class=""),n.class+=" disabled"),t.value==f&&(void 0===$.class&&($.class=""),$.class+=" disabled",void 0===g.class&&(g.class=""),g.class+=" disabled")}var f=e.$eval(n.totalItems),m=1,v=e.$eval(n.series)||u.series;e.$watch(n.ngModel,function(e,t){m=e,d()}),e.onPaginationClick=function(e){e.class&&-1!=e.class.indexOf("disabled")||(e.type===l?i.$setViewValue(e.value):e.type===a?i.$setViewValue(1):e.type===o?i.$setViewValue(m-1):e.type===r?i.$setViewValue(m+1):e.type===c&&i.$setViewValue(f),d())}}}}]).run(["$templateCache",function(e){e.put("kk/pagination.tpl.html",'<div class="pagination"><ul class="pagination"><li ng-class="item.class" ng-repeat="item in items"><a href="" ng-click="onPaginationClick(item)">{{item.value}}</a></li></ul></div>')}]),angular.module("kk.util.uploader",[]).service("$imageCompress",function(){this.compress=function(e,n,i){var a=new Image;a.src=e;var o="image/jpeg";void 0!=i&&"image/png"==i&&(o="image/png");var l=t.createElement("canvas");l.width=a.naturalWidth,l.height=a.naturalHeight;l.getContext("2d").drawImage(a,0,0);return l.toDataURL(o,n/100)}}).directive("kkImageUpload",["$parse","$imageCompress",function(e,t){var i={quality:50};return{restrict:"EA",template:'<form><input type="file" style="opacity: 0;width: 100%;height: 100%;position:absolute;display: inline-block;top:0;left:0;"></form><div ng-transclude></div>',transclude:!0,scope:!1,link:function(e,a,o){function l(){s.file&&(s.compressed=t.compress(s.file,s.quality||i.quality),s.size=s.file.length,s.compressedSize=s.compressed.length,n(e))}var s=e.$eval(o.kkImageUpload);a[0].style.position="relative";var r=a.find("form"),c=a.find("input");e.$watch(o.kkImageUpload,function(e){l()},!0),c.on("change",function(e){var t=c[0].files;if(t[0].type&&-1!==t[0].type.split("/").indexOf("image")){var n=new FileReader;n.readAsDataURL(t[0]),n.onload=function(e){s.file=e.target.result,l(),r[0].reset()}}else s.onError(t[0].type),r[0].reset()})}}}]).service("$imageCrop",["$q","$timeout",function(e,n){var i=t.createElement("canvas");this.crop=function(t,n,a,o,l,s,r){var c=e.defer(),u=t.naturalWidth/s,p=t.naturalHeight/r;i.width=s,i.height=r,i.getContext("2d").drawImage(t,n*u,a*p,o*u,l*p,0,0,s,r);var d=i.toDataURL("image/jpeg",.5);return c.resolve(d),c.promise}}]).directive("kkImageCrop",["$document","$imageCrop","$timeout",function(e,t,i){return{restrict:"EA",templateUrl:"kk/imageCrop.tpl.html",link:function(i,a,o){function l(){var e=a[0].offsetWidth,o=a[0].offsetHeight;t.crop(g,m,v,s,r,e,o).then(function(e){d.cropped=e,n(i)})}var s=(i.$eval(o.kkImageCrop),200),r=200;i.cropFile=null,a.css("position","relative");var c=angular.element('<div class="crop-box" style="position: absolute;top:20px;left:20px;width: '+s+"px;height: "+r+'px;" draggable="false" ondragstart="return false;"> <span class="crop-line-x"></span><span class="crop-line-y"></span></div>');a.append(c);var u,p,d,f=!1,m=20,v=20,h=c[0].offsetLeft,$=c[0].offsetTop,g=new Image;i.$watch(o.kkImageCrop,function(e,t){e.file&&(i.cropFile=e.file,g.src=e.file,d=e,l())},!0),c.on("mousedown",function(e){f=!0,u=e.clientX,p=e.clientY,h=c[0].offsetLeft,$=c[0].offsetTop}),c.on("mousemove",function(e){if(f){var t=e.clientX-u,n=e.clientY-p;m=h+t,v=$+n,m<0?m=0:m+c[0].clientWidth>a[0].clientWidth&&(m=a[0].clientWidth-c[0].clientWidth),v<0?v=0:v+c[0].clientHeight>a[0].clientHeight&&(v=a[0].clientHeight-c[0].clientHeight),c.css({top:v+"px",left:m+"px"}),l()}}),e.on("mouseup",function(e){f&&(f=!1)})}}}]).run(["$templateCache",function(e){e.put("kk/imageCrop.tpl.html",'<img ng-src="{{cropFile}}" style="width: 100%;user-select:none;" draggable="false" ondragstart="return false;">')}])}(window,document);